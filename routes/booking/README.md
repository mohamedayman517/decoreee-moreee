# Booking Routes Structure

هذا المجلد يحتوي على جميع routes المتعلقة بالحجوزات مقسمة إلى ملفات منفصلة لسهولة الصيانة والتطوير.

## البنية:

```
routes/booking/
├── index.js          # الملف الرئيسي الذي يجمع كل booking routes
├── create.js         # إنشاء الحجوزات وصفحات الحجز
├── payment.js        # معالجة الدفع
├── manage.js         # إدارة الحجوزات (تقييم، حذف)
├── availability.js   # التحقق من توفر المهندسين
├── helpers.js        # الدوال المساعدة المشتركة
└── README.md         # هذا الملف
```

## الملفات:

### 1. `index.js`
- الملف الرئيسي الذي يستورد ويجمع كل booking routes
- يتم استيراده في `app.js`

### 2. `create.js`
- `GET /booking` - صفحة إنشاء الحجز
- `POST /booking` - معالجة بيانات الحجز
- `POST /proceed-to-payment` - الانتقال لصفحة الدفع
- `GET /payment-success` - صفحة نجاح الدفع

### 3. `payment.js`
- `POST /process-payment` - معالجة الدفع عبر Stripe
- حفظ تفاصيل الحجز للمهندس والعميل
- التحقق من صحة البيانات

### 4. `manage.js`
- `POST /submit-review` - إرسال تقييم للحجز
- `DELETE /delete-booking/:bookingId` - حذف حجز

### 5. `availability.js`
- `POST /api/check-availability` - التحقق من توفر مهندس في تاريخ معين
- `GET /api/engineer-booked-dates/:engineerId` - جلب التواريخ المحجوزة للمهندس

### 6. `helpers.js`
- `findClientById()` - البحث عن عميل بالـ ID
- `isAuthenticated()` - middleware للتحقق من تسجيل الدخول
- `checkEngineerAvailability()` - التحقق من توفر المهندس

## المميزات:

✅ **تنظيم أفضل** - كل وظيفة في ملف منفصل
✅ **فصل المسؤوليات** - إنشاء، دفع، إدارة، توفر
✅ **دوال مساعدة مشتركة** - تجنب تكرار الكود
✅ **سهولة الصيانة** - تعديل جزء واحد دون تأثير على الباقي
✅ **قابلية القراءة** - ملفات أصغر وأكثر تركيز

## تدفق العمل:

1. **إنشاء الحجز** (`create.js`)
   - العميل يدخل صفحة الحجز
   - يختار الباقة والتاريخ
   - ينتقل لصفحة التأكيد

2. **الدفع** (`payment.js`)
   - معالجة الدفع عبر Stripe
   - حفظ تفاصيل الحجز
   - تحديث حالة الدفع

3. **الإدارة** (`manage.js`)
   - إضافة تقييمات
   - حذف الحجوزات

4. **التوفر** (`availability.js`)
   - التحقق من توفر المهندسين
   - منع الحجز المزدوج

## ملاحظات:

- تم الحفاظ على نفس الوظائف بالضبط من الملف الأصلي `BookingRoutes.js`
- لم يتم تغيير أي منطق أعمال
- تم إنشاء backup من الملف الأصلي: `BookingRoutes.js.backup`
- جميع الـ routes تعمل بنفس الطريقة السابقة
